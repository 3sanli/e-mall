CREATE TABLE User(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
mobile VARCHAR (11) NOT NULL ,
nickName VARCHAR (20) NOT NULL ,
password VARCHAR (36) NOT NULL ,
permission VARCHAR(16) NOT NULL DEFAULT 'GENERAL' ,
money BIGINT NOT NULL DEFAULT 0 ,
credit INT NOT NULL DEFAULT 0 /*1到5星*/
);

CREATE TABLE ProvinceDict(
id INT NOT NULL PRIMARY KEY ,
province VARCHAR (20) NOT NULL
);

CREATE TABLE CityDict(
id INT NOT NULL PRIMARY KEY ,
city VARCHAR (20) NOT NULL
);

CREATE TABLE AreaDict(
id INT NOT NULL PRIMARY KEY ,
area VARCHAR (20) NOT NULL
);

CREATE TABLE AddressDict(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
provinceId INT NOT NULL ,
cityId INT NOT NULL ,
areaId INT NOT NULL ,
FOREIGN KEY (provinceId) REFERENCES ProvinceDict(id) ,
FOREIGN KEY (cityId) REFERENCES CityDict(id) ,
FOREIGN KEY (areaId) REFERENCES AreaDict(id)
);

CREATE TABLE UserAddress(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
userId INT NOT NULL ,
addressDictId INT NOT NULL ,
FOREIGN KEY (userId) REFERENCES User(id) ,
FOREIGN KEY (addressDictId) REFERENCES AddressDict(id)
);

CREATE TABLE UserPicture(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
userId INT NOT NULL ,
picture VARCHAR (100) NOT NULL ,
FOREIGN KEY (userId) REFERENCES User(id)
);

CREATE TABLE ProductCategoryDict(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
category VARCHAR (20) NOT NULL
);

CREATE TABLE Product(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
name VARCHAR (30) NOT NULL ,
productCategoryId INT NOT NULL ,
price BIGINT NOT NULL ,
introduction VARCHAR (100) NOT NULL ,
creatorId INT NOT NULL ,
creatorName VARCHAR (20) NOT NULL ,
createdTime DATETIME NOT NULL DEFAULT NOW() ,
status VARCHAR (16) NOT NULL DEFAULT 'RELEASING' , /*发布中:'RELEASING',交易中:'SWAPING',已卖出:'SOLD'*/
FOREIGN KEY (productCategoryId) REFERENCES ProductCategoryDict(id) ,
FOREIGN KEY (creatorId) REFERENCES User(id)
);

CREATE TABLE ProductPicture(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
productId INT NOT NULL ,
picture VARCHAR (100) NOT NULL ,
isMain BIT DEFAULT 0 ,
FOREIGN KEY (productId) REFERENCES Product(id)
);

CREATE TABLE Buy(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
productId INT NOT NULL ,
creatorId INT NOT NULL ,
creatorName VARCHAR (20) NOT NULL ,
createdTime DATETIME NOT NULL DEFAULT NOW() ,
status VARCHAR (16) NOT NULL DEFAULT 'SWAPING' , /*交易中:'SWAPING',已废弃:'ABANDONED',已完成:'COMPLETED'*/
FOREIGN KEY (productId) REFERENCES Product(id) ,
FOREIGN KEY (creatorId) REFERENCES User(id)
);

CREATE TABLE Sold(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
productId INT NOT NULL ,
creatorId INT NOT NULL ,
creatorName VARCHAR (20) NOT NULL ,
createdTime DATETIME NOT NULL DEFAULT NOW() ,
FOREIGN KEY (productId) REFERENCES Product(id) ,
FOREIGN KEY (creatorId) REFERENCES User(id)
);

CREATE TABLE Favorites(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
productId INT NOT NULL ,
creatorId INT NOT NULL ,
creatorName VARCHAR (20) NOT NULL ,
createdTime DATETIME NOT NULL DEFAULT NOW() ,
FOREIGN KEY (productId) REFERENCES Product(id),
FOREIGN KEY (creatorId) REFERENCES User(id)
);

CREATE TABLE Comment(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
productId INT NOT NULL ,
comment VARCHAR (2000) NOT NULL ,
creatorId INT NOT NULL ,
creatorName VARCHAR (20) NOT NULL ,
createdTime DATETIME NOT NULL DEFAULT NOW() ,
FOREIGN KEY (productId) REFERENCES Product(id) ,
FOREIGN KEY (creatorId) REFERENCES User(id)
);

CREATE TABLE Score(
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
fromId INT NOT NULL ,
fromName VARCHAR (20) NOT NULL ,
toId INT NOT NULL ,
toName VARCHAR (20) NOT NULL ,
credit INT NOT NULL DEFAULT 5 ,
createdTime DATETIME NOT NULL DEFAULT NOW() ,
FOREIGN KEY (fromId) REFERENCES User(id) ,
FOREIGN KEY (toId) REFERENCES User(id)
);